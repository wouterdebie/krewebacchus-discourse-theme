/* Krewebacchus Discourse Theme
 * Cyberpunk/sci-fi styling to match the main webapp
 * Supports both Dark and Light color schemes defined in about.json
 */

/* ==================== 
   Custom Fonts
   ==================== */
@font-face {
  font-family: "Starjedi";
  src: url("https://krewebacchus.org/fonts/Starjedi.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "VideoPhreak";
  src: url("https://krewebacchus.org/fonts/VideoPhreak.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* ==================== 
   CSS Variables
   Use Discourse's color scheme variables which are set by about.json
   --primary = text color
   --secondary = background color
   --tertiary = accent color (green)
   
   Override calculated variants that Discourse gets wrong
   ==================== */
:root {
  /* Typography */
  --krew-font-mono: "Courier New", Courier, monospace;
  
  /* Override Discourse's broken auto-calculated variants */
  /* Primary variants (light text on dark bg) */
  --primary-low: rgba(248, 250, 255, 0.1) !important;
  --primary-low-mid: rgba(248, 250, 255, 0.2) !important;
  --primary-medium: rgba(248, 250, 255, 0.4) !important;
  --primary-high: rgba(248, 250, 255, 0.75) !important;
  --primary-very-high: rgba(248, 250, 255, 0.9) !important;
  --primary-very-low: rgba(248, 250, 255, 0.05) !important;
  
  /* Secondary variants (dark background shades) */
  --secondary-low: #121B29 !important;
  --secondary-medium: #1a2636 !important;
  --secondary-high: #253344 !important;
  --secondary-very-high: #344455 !important;
  
  /* Highlight (for hovers/selections) */
  --highlight-bg: rgba(57, 255, 20, 0.1) !important;
  --highlight-low: rgba(57, 255, 20, 0.05) !important;
  --highlight-medium: rgba(57, 255, 20, 0.2) !important;
  --highlight-high: rgba(57, 255, 20, 0.4) !important;
  
  /* Effects - these adapt based on tertiary color */
  --krew-glow: 0 0 10px rgba(57, 255, 20, 0.3);
  --krew-glow-strong: 0 0 15px rgba(57, 255, 20, 0.3), 0 0 30px rgba(57, 255, 20, 0.15);
  --krew-border: 1px solid rgba(57, 255, 20, 0.3);
  --krew-border-radius: 0 8px 0 8px;
}

/* ==================== 
   Base Styling
   Uses Discourse color scheme variables
   ==================== */
html {
  background: var(--secondary) !important;
}

body {
  background-color: var(--secondary) !important;
  color: var(--primary) !important;
  font-family: var(--krew-font-mono);
  font-weight: 500;
}

/* Force backgrounds on major content areas */
#main-outlet,
.wrap,
.full-width,
.container,
.contents,
.d-body,
.ember-application,
.topic-body,
.topic-area,
.list-container,
.topic-list-container,
.topic-post,
.post-stream,
main,
nav,
aside,
section,
article,
.user-content-wrapper,
.user-main,
.user-preferences,
.admin-contents,
.show-more {
  background-color: var(--secondary) !important;
}

/* Table rows */
.topic-list-item,
.topic-list-item td,
.topic-list tbody tr,
table.topic-list tbody tr,
.latest-topic-list-item,
.category-list-item,
tr {
  background-color: var(--secondary) !important;
}

/* Transparent elements */
.full-width,
.contents,
.topic-list,
.category-list,
.cooked {
  background-color: transparent !important;
}

/* ==================== 
   Typography
   ==================== */

/* Headings use Starjedi (Star Wars style) */
h1, h2, h3,
.topic-title,
.fancy-title,
.title-wrapper .topic-link {
  font-family: "Starjedi", sans-serif;
  font-weight: 500;
  text-transform: lowercase;
  letter-spacing: 0.05em;
  color: var(--primary) !important;
}

/* Category/section headers use VideoPhreak */
.category-name,
.sidebar-section-header-text,
.badge-category__name {
  font-family: "VideoPhreak", sans-serif;
  letter-spacing: 0.1em;
}

/* ==================== 
   Header
   ==================== */
.d-header-wrap,
.d-header {
  background: var(--header_background) !important;
  border-bottom: 2px solid var(--tertiary) !important;
  box-shadow: var(--krew-glow);
}

/* Logo glow effect */
.d-header .logo-big,
.d-header .logo-small {
  filter: drop-shadow(0 0 8px rgba(57, 255, 20, 0.3));
}

/* Header icons */
.d-header-icons .icon {
  color: var(--tertiary) !important;
  transition: all 0.3s ease;
}

.d-header-icons .icon:hover {
  filter: drop-shadow(0 0 8px rgba(57, 255, 20, 0.5));
}

/* ==================== 
   Links
   ==================== */
a,
.title a,
.topic-list .main-link a.title,
.topic-list-item .title,
.sidebar-section-link-wrapper a,
.nav-pills > li > a {
  color: var(--tertiary) !important;
  transition: all 0.2s ease;
}

a:hover,
.topic-list-item .title:hover {
  filter: brightness(1.2);
}

/* Muted/secondary links */
.topic-list .link-bottom-line a,
.link-bottom-line a {
  color: var(--primary-medium) !important;
}

/* ==================== 
   Navigation & Sidebar
   ==================== */
.sidebar-wrapper,
.sidebar-container,
.sidebar-sections,
.sidebar-section,
.sidebar-section-wrapper,
.sidebar-section-content,
nav.sidebar {
  background-color: var(--secondary) !important;
  border-right: var(--krew-border);
}

.sidebar-section-header-wrapper {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
  text-transform: uppercase;
  font-size: 0.75rem;
  letter-spacing: 0.1em;
}

.sidebar-section-link {
  border-radius: var(--krew-border-radius);
  transition: all 0.2s ease;
  color: var(--primary) !important;
}

.sidebar-section-link:hover,
.sidebar-section-link.active {
  background-color: var(--highlight-bg) !important;
  box-shadow: inset 0 0 10px rgba(57, 255, 20, 0.2);
}

.sidebar-section-link.active {
  border-left: 2px solid var(--tertiary);
}

/* ==================== 
   Topic List
   ==================== */
.topic-list th,
.topic-list-header {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
  text-transform: uppercase;
  font-size: 0.7rem;
  letter-spacing: 0.1em;
  border-bottom: var(--krew-border) !important;
  background: transparent !important;
}

.topic-list-item {
  border-bottom: 1px solid var(--primary-low) !important;
  transition: all 0.2s ease;
}

.topic-list-item:hover {
  background-color: var(--highlight-bg) !important;
  box-shadow: var(--krew-glow);
}

/* Pinned topics */
.topic-list-item.pinned .title::before {
  color: var(--warning) !important;
}

/* ==================== 
   Topic View
   ==================== */
.topic-body {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
}

.topic-post {
  border-bottom: 1px solid var(--primary-low);
}

/* Post content */
.cooked {
  color: var(--primary) !important;
}

.cooked a {
  color: var(--quaternary) !important;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.2s ease;
}

.cooked a:hover {
  color: var(--tertiary) !important;
  border-bottom-color: var(--tertiary);
}

/* Code blocks */
.cooked pre,
.cooked code {
  background-color: var(--primary-very-low) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
  font-family: var(--krew-font-mono);
}

.cooked pre code {
  color: var(--tertiary) !important;
}

/* Blockquotes */
.cooked blockquote {
  background-color: rgba(20, 207, 255, 0.1) !important;
  border-left: 3px solid var(--quaternary) !important;
  padding-left: 1rem;
}

/* ==================== 
   Buttons
   ==================== */
.btn-primary,
.btn.btn-primary,
.btn.btn-primary.login-button {
  background: rgba(57, 255, 20, 0.15) !important;
  border: 1px solid var(--tertiary) !important;
  color: var(--tertiary) !important;
  font-weight: 600;
  border-radius: var(--krew-border-radius);
  transition: all 0.3s ease;
  text-shadow: none !important;
}

.btn-primary:hover,
.btn.btn-primary:hover,
.btn.btn-primary.login-button:hover {
  background: rgba(57, 255, 20, 0.25) !important;
  box-shadow: var(--krew-glow);
  transform: translateY(-1px);
}

.btn-default,
.btn.btn-default,
.btn {
  background-color: var(--secondary-low) !important;
  border: 1px solid var(--primary-low) !important;
  color: var(--primary) !important;
  border-radius: var(--krew-border-radius);
  transition: all 0.2s ease;
}

.btn-default:hover,
.btn.btn-default:hover,
.btn:hover {
  background-color: var(--highlight-bg) !important;
  border-color: rgba(57, 255, 20, 0.4) !important;
}

.btn-danger,
.btn.btn-danger {
  background-color: var(--danger) !important;
  border: none !important;
  color: white !important;
  border-radius: var(--krew-border-radius);
}

/* ==================== 
   Forms & Inputs
   ==================== */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="search"],
textarea,
select,
.select-kit .select-kit-header,
.search-input,
.search-input--welcome-banner,
.search-container .search-input {
  background-color: var(--secondary-low) !important;
  border: 1px solid var(--primary-low) !important;
  border-radius: var(--krew-border-radius);
  color: var(--primary) !important;
  transition: all 0.2s ease;
}

input:focus,
textarea:focus,
select:focus,
.search-input:focus,
.search-input--welcome-banner:focus,
.select-kit.is-expanded .select-kit-header {
  border-color: rgba(57, 255, 20, 0.4) !important;
  outline: none;
  box-shadow: 0 0 5px rgba(57, 255, 20, 0.15);
}

/* ==================== 
   Categories
   ==================== */
.category-list-item {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
  margin-bottom: 0.5rem;
  transition: all 0.2s ease;
}

.category-list-item:hover {
  border-color: var(--tertiary);
  box-shadow: var(--krew-glow);
}

/* Category badges */
.badge-category__wrapper {
  font-family: var(--krew-font-mono);
}

/* ==================== 
   User Cards & Profiles
   ==================== */
.user-card,
.user-card-large {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
  box-shadow: var(--krew-glow);
}

.user-card h1,
.user-card h2 {
  color: var(--tertiary) !important;
}

/* Avatar glow for admins/captains */
.user-card.admin .avatar-flair,
.user-card.moderator .avatar-flair {
  box-shadow: var(--krew-glow-strong);
}

/* ==================== 
   Notifications & Badges
   ==================== */
.badge-notification {
  background-color: var(--tertiary) !important;
  color: var(--secondary) !important;
  font-weight: 600;
}

.badge-notification.unread-posts,
.badge-notification.new-posts {
  background-color: var(--quaternary) !important;
}

/* User badges */
.user-badge {
  background-color: var(--highlight-bg) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
}

/* ==================== 
   Modals & Popups
   ==================== */
.modal-inner-container,
.d-modal__container {
  background-color: var(--secondary) !important;
  border: var(--krew-border);
  border-radius: 8px;
  box-shadow: var(--krew-glow-strong);
}

.modal-header,
.d-modal__header {
  border-bottom: var(--krew-border);
}

.modal-header h3,
.d-modal__title {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
}

/* ==================== 
   Chat
   ==================== */
.chat-channel {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
}

.chat-message {
  border-bottom: 1px solid var(--primary-low);
}

.chat-message:hover {
  background-color: var(--highlight-bg) !important;
}

.chat-composer-input {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
}

/* ==================== 
   Loading & Animations
   ==================== */
.spinner {
  border-color: var(--tertiary) !important;
  border-right-color: transparent !important;
}

/* Page loading bar */
#discourse-loading-spinner {
  background-color: var(--tertiary) !important;
  box-shadow: var(--krew-glow-strong);
}

/* Subtle scan line effect for sci-fi feel - only in dark mode */
@keyframes scanline {
  0% {
    transform: translateY(-100%);
  }
  100% {
    transform: translateY(100vh);
  }
}

/* ==================== 
   Scrollbars
   ==================== */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--secondary);
}

::-webkit-scrollbar-thumb {
  background: var(--primary-low);
  border: 1px solid rgba(57, 255, 20, 0.3);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--tertiary);
  border-color: var(--tertiary);
}

/* ==================== 
   Groups (SubKrewes)
   ==================== */
.group-box {
  background-color: var(--secondary-low) !important;
  border: var(--krew-border);
  border-radius: var(--krew-border-radius);
}

.group-box:hover {
  border-color: var(--tertiary);
  box-shadow: var(--krew-glow);
}

/* ==================== 
   Footer
   ==================== */
.custom-footer,
footer,
.powered-by-discourse {
  background-color: transparent !important;
  border-top: var(--krew-border);
  color: var(--primary-medium) !important;
}

.powered-by-discourse a {
  color: var(--primary-medium) !important;
}

/* ==================== 
   Welcome banner
   ==================== */
.welcome-banner,
.welcome-banner__header {
  background: transparent !important;
  color: var(--primary) !important;
}

.welcome-banner__title {
  color: var(--primary) !important;
}

/* ==================== 
   Text colors
   ==================== */
.topic-excerpt,
.category-description {
  color: var(--primary-medium) !important;
}

/* Numbers/stats */
.topic-list .num,
td.num,
.views,
.posts {
  color: var(--primary-medium) !important;
}

/* ==================== 
   Dark Mode Specific - Scanline effect
   ==================== */
@media (prefers-color-scheme: dark) {
  body::after {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, rgba(57, 255, 20, 0.3), transparent);
    pointer-events: none;
    animation: scanline 6s linear infinite;
    opacity: 0.3;
    z-index: 9999;
  }
}

/* ==================== 
   Responsive Adjustments
   ==================== */
@media (max-width: 768px) {
  .topic-list-item {
    border-radius: 4px;
  }
  
  /* Disable scanline on mobile for performance */
  body::after {
    display: none !important;
  }
}
