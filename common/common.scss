/* Krewebacchus Discourse Theme
 * Cyberpunk/sci-fi styling to match the main webapp
 * Fully scheme-agnostic - uses Discourse's CSS variables which adapt per scheme
 */

/* ==================== 
   Custom Fonts
   ==================== */
@font-face {
  font-family: "Starjedi";
  src: url("https://chewbacchus.org/wp-content/themes/elevated-lite/assets/fonts/starjedi/Starjedi.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "VideoPhreak";
  src: url("https://chewbacchus.org/wp-content/themes/elevated-lite/assets/fonts/videophreak/VideoPhreak.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* ==================== 
   CSS Variables
   Using color-mix() with base variables for true scheme-agnostic styling
   This adapts automatically because --primary is light in dark mode and dark in light mode
   ==================== */
:root {
  /* Typography */
  --krew-font-mono: "Courier New", Courier, monospace;
  --krew-border-radius: 0 8px 0 8px;
  
  /* Scheme-agnostic colors using color-mix with base --primary */
  /* These automatically adapt: --primary is #F8FAFF (light) in dark mode, #121B29 (dark) in light mode */
  --krew-border: color-mix(in srgb, var(--primary) 15%, transparent);
  --krew-border-subtle: color-mix(in srgb, var(--primary) 8%, transparent);
  --krew-accent-border: color-mix(in srgb, var(--tertiary) 40%, transparent);
  --krew-hover-bg: color-mix(in srgb, var(--primary) 5%, transparent);
  --krew-text-muted: color-mix(in srgb, var(--primary) 60%, transparent);
  
  /* Override Discourse's broken auto-calculated variables using color-mix */
  /* Primary variants */
  --primary-low: color-mix(in srgb, var(--primary) 12%, transparent) !important;
  --primary-very-low: color-mix(in srgb, var(--primary) 6%, transparent) !important;
  --primary-medium: color-mix(in srgb, var(--primary) 55%, transparent) !important;
  --primary-high: color-mix(in srgb, var(--primary) 75%, transparent) !important;
  --primary-low-mid: color-mix(in srgb, var(--primary) 22%, transparent) !important;
  --primary-50: color-mix(in srgb, var(--primary) 6%, transparent) !important;
  --primary-100: color-mix(in srgb, var(--primary) 12%, transparent) !important;
  --primary-200: color-mix(in srgb, var(--primary) 18%, transparent) !important;
  --primary-300: color-mix(in srgb, var(--primary) 25%, transparent) !important;
  --primary-400: color-mix(in srgb, var(--primary) 40%, transparent) !important;
  --primary-500: color-mix(in srgb, var(--primary) 55%, transparent) !important;
  --primary-600: color-mix(in srgb, var(--primary) 68%, transparent) !important;
  --primary-700: color-mix(in srgb, var(--primary) 78%, transparent) !important;
  
  /* Tertiary variants (green accent) */
  --tertiary-low: color-mix(in srgb, var(--tertiary) 12%, transparent) !important;
  --tertiary-very-low: color-mix(in srgb, var(--tertiary) 6%, transparent) !important;
  --tertiary-medium: color-mix(in srgb, var(--tertiary) 55%, transparent) !important;
  --tertiary-high: color-mix(in srgb, var(--tertiary) 75%, transparent) !important;
  
  /* Secondary variants */
  --secondary-low: color-mix(in srgb, var(--primary) 10%, transparent) !important;
  --secondary-very-low: color-mix(in srgb, var(--primary) 5%, transparent) !important;
  --secondary-medium: color-mix(in srgb, var(--primary) 18%, transparent) !important;
  --secondary-high: color-mix(in srgb, var(--primary) 28%, transparent) !important;
  
  /* Highlight variants (use tertiary/green) */
  --highlight-low: color-mix(in srgb, var(--tertiary) 8%, transparent) !important;
  --highlight-medium: color-mix(in srgb, var(--tertiary) 20%, transparent) !important;
  --highlight-high: color-mix(in srgb, var(--tertiary) 32%, transparent) !important;
}

/* ==================== 
   Base Styling
   Uses Discourse color scheme variables that auto-adapt
   ==================== */
html {
  background: var(--secondary) !important;
}

body {
  background-color: var(--secondary) !important;
  color: var(--primary) !important;
  font-family: var(--krew-font-mono);
  font-weight: 500;
}

/* Force backgrounds on major content areas */
#main-outlet,
.wrap,
.full-width,
.container,
.contents,
.d-body,
.ember-application,
.topic-body,
.topic-area,
.list-container,
.topic-list-container,
.topic-post,
.post-stream,
main,
nav,
aside,
section,
article,
.user-content-wrapper,
.user-main,
.user-preferences,
.admin-contents,
.show-more {
  background-color: var(--secondary) !important;
}

/* Table rows */
.topic-list-item,
.topic-list-item td,
.topic-list tbody tr,
table.topic-list tbody tr,
.latest-topic-list-item,
.category-list-item,
tr {
  background-color: var(--secondary) !important;
}

/* Transparent elements */
.full-width,
.contents,
.topic-list,
.category-list,
.cooked {
  background-color: transparent !important;
}

/* ==================== 
   Typography
   ==================== */

/* Headings use Starjedi (Star Wars style) */
h1, h2, h3,
.topic-title,
.fancy-title,
.title-wrapper .topic-link {
  font-family: "Starjedi", sans-serif;
  font-weight: 500;
  text-transform: lowercase;
  letter-spacing: 0.05em;
  color: var(--primary) !important;
}

/* Category/section headers use VideoPhreak */
.category-name,
.sidebar-section-header-text,
.badge-category__name {
  font-family: "VideoPhreak", sans-serif;
  letter-spacing: 0.1em;
}

/* ==================== 
   Header
   ==================== */
.d-header-wrap,
.d-header {
  background: var(--secondary) !important;
  border-bottom: 2px solid var(--tertiary) !important;
}

/* Logo glow effect - subtle */
.d-header .logo-big,
.d-header .logo-small {
  filter: drop-shadow(0 0 4px var(--krew-border));
}

/* Header icons */
.d-header-icons .icon {
  color: var(--tertiary) !important;
  transition: all 0.3s ease;
}

.d-header-icons .icon:hover {
  filter: brightness(1.2);
}

/* ==================== 
   Links
   ==================== */
a,
.title a,
.topic-list .main-link a.title,
.topic-list-item .title,
.sidebar-section-link-wrapper a,
.nav-pills > li > a {
  color: var(--tertiary) !important;
  transition: all 0.2s ease;
}

a:hover,
.topic-list-item .title:hover {
  filter: brightness(1.2);
}

/* Muted/secondary links */
.topic-list .link-bottom-line a,
.link-bottom-line a {
  color: var(--krew-text-muted) !important;
}

/* ==================== 
   Navigation & Sidebar
   ==================== */
.sidebar-wrapper,
.sidebar-container,
.sidebar-sections,
.sidebar-section,
.sidebar-section-wrapper,
.sidebar-section-content,
nav.sidebar {
  background-color: var(--secondary) !important;
  border-right: 1px solid var(--krew-border);
}

.sidebar-section-header-wrapper {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
  text-transform: uppercase;
  font-size: 0.75rem;
  letter-spacing: 0.1em;
}

.sidebar-section-link {
  border-radius: var(--krew-border-radius);
  transition: all 0.2s ease;
  color: var(--primary) !important;
}

.sidebar-section-link:hover,
.sidebar-section-link.active {
  background-color: var(--krew-hover-bg) !important;
  box-shadow: inset 0 0 10px var(--krew-hover-bg);
}

.sidebar-section-link.active {
  border-left: 2px solid var(--tertiary);
}

/* ==================== 
   Topic List
   ==================== */
.topic-list th,
.topic-list-header {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
  text-transform: uppercase;
  font-size: 0.7rem;
  letter-spacing: 0.1em;
  border-bottom: 1px solid var(--krew-border) !important;
  background: transparent !important;
}

.topic-list-item {
  border-bottom: 1px solid var(--krew-border) !important;
  transition: all 0.2s ease;
}

.topic-list-item:hover {
  background-color: var(--krew-hover-bg) !important;
  box-shadow: 0 0 10px var(--krew-hover-bg);
}

/* Pinned topics */
.topic-list-item.pinned .title::before {
  color: var(--warning) !important;
}

/* ==================== 
   Topic View
   ==================== */
.topic-body {
  background-color: var(--krew-hover-bg) !important;
  border: none !important;
  border-radius: var(--krew-border-radius);
  padding: 0.75rem 1rem !important;
}

/* Post row - remove left border */
.post__row {
  border-left: none !important;
}

.topic-post {
  border-bottom: none !important;
  padding: 0.5rem 0;
}

/* Hide "Powered by Discourse" footer */
.powered-by-discourse {
  display: none !important;
}

/* System user avatar - make smaller */
.topic-avatar a[data-user-card="system"] img.avatar,
.post-avatar a[data-user-card="system"] img.avatar {
  width: 32px !important;
  height: 32px !important;
}

/* General avatar container */
.topic-avatar {
  padding-right: 0.75rem;
}

/* Post content */
.cooked {
  color: var(--primary) !important;
}

.cooked a {
  color: var(--quaternary) !important;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.2s ease;
}

.cooked a:hover {
  color: var(--tertiary) !important;
  border-bottom-color: var(--tertiary);
}

/* Code blocks */
.cooked pre,
.cooked code {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
  border-radius: var(--krew-border-radius);
  font-family: var(--krew-font-mono);
}

.cooked pre code {
  color: var(--tertiary) !important;
}

/* Blockquotes */
.cooked blockquote {
  background-color: var(--quaternary-low) !important;
  border-left: 3px solid var(--quaternary) !important;
  padding-left: 1rem;
}

/* ==================== 
   Buttons - Primary (Green accent)
   Uses pseudo-element for scheme-adaptive tinted background
   ==================== */
.btn-primary,
.btn.btn-primary,
.btn.btn-primary.login-button {
  position: relative;
  background: transparent !important;
  border: 1px solid var(--tertiary) !important;
  color: var(--tertiary) !important;
  font-weight: 600;
  border-radius: var(--krew-border-radius);
  transition: all 0.3s ease;
  text-shadow: none !important;
  overflow: hidden;
  z-index: 1;
}

.btn-primary::before,
.btn.btn-primary::before,
.btn.btn-primary.login-button::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--tertiary);
  opacity: 0.15;
  z-index: -1;
  transition: opacity 0.3s ease;
}

.btn-primary:hover::before,
.btn.btn-primary:hover::before,
.btn.btn-primary.login-button:hover::before {
  opacity: 0.25;
}

.btn-primary:hover,
.btn.btn-primary:hover,
.btn.btn-primary.login-button:hover {
  box-shadow: 0 0 10px var(--krew-border);
  transform: translateY(-1px);
}

/* ==================== 
   Buttons - Default
   ==================== */
.btn-default,
.btn.btn-default,
.btn {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border) !important;
  color: var(--primary) !important;
  border-radius: var(--krew-border-radius);
  transition: all 0.2s ease;
}

.btn-default:hover,
.btn.btn-default:hover,
.btn:hover {
  background-color: var(--krew-hover-bg) !important;
  border-color: var(--krew-border) !important;
}

/* Flat/Icon-only buttons - no border or background */
.btn-flat,
.btn.btn-flat,
.btn-icon,
.btn.btn-icon,
.btn.no-text,
.btn-transparent,
.btn.btn-transparent,
.chat-composer-dropdown__trigger-btn,
.chat-emoji-btn,
.chat-composer-button,
.d-icon-button {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

.btn-flat:hover,
.btn.btn-flat:hover,
.btn-icon:hover,
.btn.btn-icon:hover,
.btn.no-text:hover,
.btn-transparent:hover,
.btn.btn-transparent:hover,
.chat-composer-dropdown__trigger-btn:hover,
.chat-emoji-btn:hover,
.chat-composer-button:hover,
.d-icon-button:hover {
  background: var(--krew-hover-bg) !important;
  border: none !important;
}

.btn-danger,
.btn.btn-danger {
  background-color: var(--danger) !important;
  border: none !important;
  color: white !important;
  border-radius: var(--krew-border-radius);
}

/* ==================== 
   Button Groups & Containers
   ==================== */
.btn-group,
.d-button-group,
[class*="btn-group"],
[class*="button-row"],
[class*="actions"] {
  display: flex;
  gap: 0.25rem;
}

/* Adjacent buttons get margin */
.btn + .btn,
button + button,
button + .btn,
.btn + button {
  margin-left: 0.25rem;
}

/* ==================== 
   Forms & Inputs
   ==================== */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="search"],
textarea,
select,
.select-kit .select-kit-header,
.search-input,
.search-input--welcome-banner,
.search-container .search-input {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border) !important;
  border-radius: var(--krew-border-radius);
  color: var(--primary) !important;
  transition: all 0.2s ease;
}

/* Welcome banner search - remove double borders from nested elements */
.search-input--welcome-banner input,
.search-input--welcome-banner .search-term__input,
.search-input--welcome-banner .btn,
.search-input--welcome-banner button {
  border: none !important;
  background: transparent !important;
  box-shadow: none !important;
}

input:focus,
textarea:focus,
select:focus,
.search-input:focus,
.search-input--welcome-banner:focus,
.select-kit.is-expanded .select-kit-header {
  border-color: var(--tertiary) !important;
  outline: none;
  box-shadow: 0 0 5px var(--krew-border);
}

/* ==================== 
   Categories
   ==================== */
.category-list-item {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
  border-radius: var(--krew-border-radius);
  margin-bottom: 0.5rem;
  transition: all 0.2s ease;
}

.category-list-item:hover {
  border-color: var(--tertiary);
  box-shadow: 0 0 10px var(--krew-border);
}

/* Category badges */
.badge-category__wrapper {
  font-family: var(--krew-font-mono);
}

/* ==================== 
   User Cards & Profiles
   ==================== */
.user-card,
.user-card-large {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
  border-radius: var(--krew-border-radius);
  box-shadow: 0 0 10px var(--krew-border);
}

.user-card h1,
.user-card h2 {
  color: var(--tertiary) !important;
}

/* Avatar glow for admins/captains */
.user-card.admin .avatar-flair,
.user-card.moderator .avatar-flair {
  box-shadow: 0 0 15px var(--krew-border), 0 0 30px var(--krew-hover-bg);
}

/* ==================== 
   Notifications & Badges
   ==================== */
.badge-notification {
  background-color: var(--tertiary) !important;
  color: var(--secondary) !important;
  font-weight: 600;
}

.badge-notification.unread-posts,
.badge-notification.new-posts {
  background-color: var(--quaternary) !important;
}

/* User badges */
.user-badge {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
  border-radius: var(--krew-border-radius);
}

/* ==================== 
   Modals & Popups
   ==================== */
.modal-inner-container,
.d-modal__container {
  background-color: var(--secondary) !important;
  border: 1px solid var(--krew-border);
  border-radius: 8px;
  box-shadow: 0 0 15px var(--krew-border), 0 0 30px var(--krew-hover-bg);
}

.modal-header,
.d-modal__header {
  border-bottom: 1px solid var(--krew-border);
}

.modal-header h3,
.d-modal__title {
  color: var(--tertiary) !important;
  font-family: var(--krew-font-mono);
}

/* ==================== 
   Chat
   ==================== */
.chat-channel {
  background-color: var(--secondary) !important;
  border: 1px solid var(--krew-border);
}

.chat-message {
  border-bottom: 1px solid var(--krew-border);
}

.chat-message:hover {
  background-color: var(--krew-hover-bg) !important;
}

.chat-composer-input {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
}

/* Chat composer wrapper and container */
.chat-composer,
.chat-composer__wrapper,
.chat-composer-container,
.chat-composer-row,
.chat-composer__outer-container,
.chat-composer__inner-container,
.chat-composer__input-container,
.chat-composer__buttons,
.chat-drawer,
.chat-drawer-content,
.chat-full-page-chat,
.chat-channel-preview-card,
.chat-message-container,
.chat-messages-container,
.chat-messages-scroll {
  background-color: var(--secondary) !important;
}

/* Chat input textarea */
.chat-composer-input textarea,
.chat-composer textarea,
.chat-composer .d-editor-input,
.chat-composer .chat-composer-input {
  background-color: var(--secondary) !important;
  border: 1px solid var(--krew-border) !important;
  color: var(--primary) !important;
}

/* Chat sidebar/drawer */
.chat-drawer-header,
.chat-channel-title {
  background-color: var(--secondary) !important;
  border-bottom: 1px solid var(--krew-border) !important;
}

/* Chat button containers - add spacing between buttons */
.chat-composer-button-row,
.chat-composer__send-btn-group,
.chat-channel-row__buttons,
.chat-channel-header__right-actions,
.chat-drawer-header__right-actions,
.chat-full-page-header__right-actions,
.chat-composer-dropdown__trigger-container,
.d-chat-btn-group {
  display: flex;
  gap: 0.5rem !important;
}

/* Ensure buttons in chat have proper margin */
.chat-composer .btn,
.chat-composer button,
.chat-drawer .btn,
.chat-drawer button,
.chat-channel .btn,
.chat-channel button,
.chat-full-page-header .btn,
.chat-full-page-header button {
  margin: 0.125rem !important;
}

/* Header controls in chat */
.chat-channel-header,
.chat-drawer-header,
.chat-full-page-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.chat-channel-header .btn + .btn,
.chat-drawer-header .btn + .btn,
.chat-full-page-header .btn + .btn {
  margin-left: 0.25rem;
}

/* ==================== 
   Loading & Animations
   ==================== */
.spinner {
  border-color: var(--tertiary) !important;
  border-right-color: transparent !important;
}

/* Page loading bar */
#discourse-loading-spinner {
  background-color: var(--tertiary) !important;
  box-shadow: 0 0 15px var(--krew-border), 0 0 30px var(--krew-hover-bg);
}

/* Subtle scan line effect for sci-fi feel */
@keyframes scanline {
  0% {
    transform: translateY(-100%);
  }
  100% {
    transform: translateY(100vh);
  }
}

/* ==================== 
   Scrollbars
   ==================== */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--secondary);
}

::-webkit-scrollbar-thumb {
  background: var(--krew-border);
  border: 1px solid var(--krew-border);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--tertiary);
  border-color: var(--tertiary);
}

/* ==================== 
   Groups (SubKrewes)
   ==================== */
.group-box {
  background-color: var(--krew-hover-bg) !important;
  border: 1px solid var(--krew-border);
  border-radius: var(--krew-border-radius);
}

.group-box:hover {
  border-color: var(--tertiary);
  box-shadow: 0 0 10px var(--krew-border);
}

/* ==================== 
   Footer
   ==================== */
.custom-footer,
footer,
.powered-by-discourse {
  background-color: transparent !important;
  border-top: 1px solid var(--krew-border);
  color: var(--krew-text-muted) !important;
}

.powered-by-discourse a {
  color: var(--krew-text-muted) !important;
}

/* ==================== 
   Welcome banner
   ==================== */
.welcome-banner,
.welcome-banner__header {
  background: transparent !important;
  color: var(--primary) !important;
}

.welcome-banner__title {
  color: var(--primary) !important;
}

/* ==================== 
   Text colors
   ==================== */
.topic-excerpt,
.category-description {
  color: var(--krew-text-muted) !important;
}

/* Numbers/stats */
.topic-list .num,
td.num,
.views,
.posts {
  color: var(--krew-text-muted) !important;
}

/* ==================== 
   Responsive Adjustments
   ==================== */
@media (max-width: 768px) {
  .topic-list-item {
    border-radius: 4px;
  }
}
